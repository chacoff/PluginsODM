# import pyodbc
# import pandas as pd

# connection_string = (
#     r"Driver={ODBC Driver 17 for SQL Server};"
#     r"Server=\\.\pipe\LOCALDB#C27096BB\tsql\query;"
#     r"Database=scraps;"
#     r"Trusted_Connection=yes;"
# )

# conn = pyodbc.connect(connection_string)
# query = "SELECT * FROM dbo.BLV"
# df = pd.read_sql(query, conn)
# conn.close()
# print(df)

# df['flightDay'] = pd.to_datetime(df['flightDay'])
# date_strings = df['flightDay'].dt.strftime('%Y-%m-%d').unique().tolist()
# print(date_strings)

import psycopg2
import pandas as pd

conn_params = {
    "dbname": "waste_management",
    "user": "postgres",
    "password": "API",
    "host": "localhost",
    "port": "5432"
}

try:
    connection = psycopg2.connect(**conn_params)
    query = "SELECT * FROM SCRAP_BLV;"
    
    df = pd.read_sql(query, connection)

    print(df)
    connection.close()

except Exception as e:
    print(f"Error connecting to the database: {e}")

df['flightday'] = pd.to_datetime(df['flightday'])
date_strings = df['flightday'].dt.strftime('%Y-%m-%d').unique().tolist()
print(date_strings)


''' SQL

CREATE TABLE public.SCRAP_BLV (
    flightDay DATE NOT NULL,
    pile VARCHAR(10) NOT NULL,
    volume INT NOT NULL,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT PK_flightDay_pile UNIQUE (flightDay, pile)
);

INSERT INTO SCRAP_BLV (flightDay, pile, volume, updated_at) VALUES 
-- 2024-10-31
('2024-10-31', 'SH', 500, CURRENT_TIMESTAMP),
('2024-10-31', 'SC', 3100, CURRENT_TIMESTAMP),
('2024-10-31', 'TA', 2700, CURRENT_TIMESTAMP),
('2024-10-31', 'NL', 1900, CURRENT_TIMESTAMP),
('2024-10-31', 'NE', 1300, CURRENT_TIMESTAMP),
('2024-10-31', 'PN', 2300, CURRENT_TIMESTAMP),
('2024-10-31', 'HA', 1600, CURRENT_TIMESTAMP),
('2024-10-31', 'TS', 950, CURRENT_TIMESTAMP),
('2024-10-31', 'XT', 2550, CURRENT_TIMESTAMP),
('2024-10-31', 'SH2', 2100, CURRENT_TIMESTAMP),
('2024-10-31', 'NL2', 1650, CURRENT_TIMESTAMP),
('2024-10-31', 'TA2', 4050, CURRENT_TIMESTAMP),
('2024-10-31', 'PN2', 2850, CURRENT_TIMESTAMP),
('2024-10-31', 'SC2', 1050, CURRENT_TIMESTAMP),
('2024-10-31', 'HS', 1750, CURRENT_TIMESTAMP),
('2024-10-31', 'JG', 1350, CURRENT_TIMESTAMP),
('2024-10-31', 'GJ', 2450, CURRENT_TIMESTAMP),
('2024-10-31', 'PS', 1150, CURRENT_TIMESTAMP),
('2024-10-31', 'LS', 850, CURRENT_TIMESTAMP),
('2024-10-31', 'NS', 2650, CURRENT_TIMESTAMP),
('2024-10-31', 'KR', 3750, CURRENT_TIMESTAMP),
('2024-10-31', 'BD', 1950, CURRENT_TIMESTAMP),
('2024-10-31', 'KS', 2150, CURRENT_TIMESTAMP),

-- 2024-09-30
('2024-09-30', 'SH', 150, CURRENT_TIMESTAMP),
('2024-09-30', 'SC', 1150, CURRENT_TIMESTAMP),
('2024-09-30', 'TA', 2750, CURRENT_TIMESTAMP),
('2024-09-30', 'NL', 1920, CURRENT_TIMESTAMP),
('2024-09-30', 'NE', 1320, CURRENT_TIMESTAMP),
('2024-09-30', 'PN', 2350, CURRENT_TIMESTAMP),
('2024-09-30', 'HA', 3050, CURRENT_TIMESTAMP),
('2024-09-30', 'TS', 980, CURRENT_TIMESTAMP),
('2024-09-30', 'XT', 580, CURRENT_TIMESTAMP),
('2024-09-30', 'SH2', 2200, CURRENT_TIMESTAMP),
('2024-09-30', 'NL2', 1680, CURRENT_TIMESTAMP),
('2024-09-30', 'TA2', 717, CURRENT_TIMESTAMP),
('2024-09-30', 'PN2', 880, CURRENT_TIMESTAMP),
('2024-09-30', 'SC2', 1080, CURRENT_TIMESTAMP),
('2024-09-30', 'HS', 178, CURRENT_TIMESTAMP),
('2024-09-30', 'JG', 1380, CURRENT_TIMESTAMP),
('2024-09-30', 'GJ', 2480, CURRENT_TIMESTAMP),
('2024-09-30', 'PS', 1180, CURRENT_TIMESTAMP),
('2024-09-30', 'LS', 880, CURRENT_TIMESTAMP),
('2024-09-30', 'NS', 2680, CURRENT_TIMESTAMP),
('2024-09-30', 'KR', 380, CURRENT_TIMESTAMP),
('2024-09-30', 'BD', 1980, CURRENT_TIMESTAMP),
('2024-09-30', 'KS', 2180, CURRENT_TIMESTAMP),

-- 2024-08-31
('2024-08-31', 'SH', 130, CURRENT_TIMESTAMP),
('2024-08-31', 'SC', 1820, CURRENT_TIMESTAMP),
('2024-08-31', 'TA', 2780, CURRENT_TIMESTAMP),
('2024-08-31', 'NL', 1940, CURRENT_TIMESTAMP),
('2024-08-31', 'NE', 1340, CURRENT_TIMESTAMP),
('2024-08-31', 'PN', 2380, CURRENT_TIMESTAMP),
('2024-08-31', 'HA', 2680, CURRENT_TIMESTAMP),
('2024-08-31', 'TS', 990, CURRENT_TIMESTAMP),
('2024-08-31', 'XT', 590, CURRENT_TIMESTAMP),
('2024-08-31', 'SH2', 1250, CURRENT_TIMESTAMP),
('2024-08-31', 'NL2', 2690, CURRENT_TIMESTAMP),
('2024-08-31', 'TA2', 1150, CURRENT_TIMESTAMP),
('2024-08-31', 'PN2', 200, CURRENT_TIMESTAMP),
('2024-08-31', 'SC2', 190, CURRENT_TIMESTAMP),
('2024-08-31', 'HS', 1790, CURRENT_TIMESTAMP),
('2024-08-31', 'JG', 1390, CURRENT_TIMESTAMP),
('2024-08-31', 'GJ', 2490, CURRENT_TIMESTAMP),
('2024-08-31', 'PS', 1190, CURRENT_TIMESTAMP),
('2024-08-31', 'LS', 890, CURRENT_TIMESTAMP),
('2024-08-31', 'NS', 2690, CURRENT_TIMESTAMP),
('2024-08-31', 'KR', 3790, CURRENT_TIMESTAMP),
('2024-08-31', 'BD', 1990, CURRENT_TIMESTAMP),
('2024-08-31', 'KS', 2190, CURRENT_TIMESTAMP),

-- 2024-07-31
('2024-07-31', 'SH', 550, CURRENT_TIMESTAMP),
('2024-07-31', 'SC', 2200, CURRENT_TIMESTAMP),
('2024-07-31', 'TA', 200, CURRENT_TIMESTAMP),
('2024-07-31', 'NL', 1960, CURRENT_TIMESTAMP),
('2024-07-31', 'NE', 1360, CURRENT_TIMESTAMP),
('2024-07-31', 'PN', 2400, CURRENT_TIMESTAMP),
('2024-07-31', 'HA', 3060, CURRENT_TIMESTAMP),
('2024-07-31', 'TS', 1000, CURRENT_TIMESTAMP),
('2024-07-31', 'XT', 600, CURRENT_TIMESTAMP),
('2024-07-31', 'SH2', 2300, CURRENT_TIMESTAMP),
('2024-07-31', 'NL2', 720, CURRENT_TIMESTAMP),
('2024-07-31', 'TA2', 420, CURRENT_TIMESTAMP),
('2024-07-31', 'PN2', 2950, CURRENT_TIMESTAMP),
('2024-07-31', 'SC2', 1120, CURRENT_TIMESTAMP),
('2024-07-31', 'HS', 1820, CURRENT_TIMESTAMP),
('2024-07-31', 'JG', 1420, CURRENT_TIMESTAMP),
('2024-07-31', 'GJ', 2520, CURRENT_TIMESTAMP),
('2024-07-31', 'PS', 1220, CURRENT_TIMESTAMP),
('2024-07-31', 'LS', 920, CURRENT_TIMESTAMP),
('2024-07-31', 'NS', 2720, CURRENT_TIMESTAMP),
('2024-07-31', 'KR', 320, CURRENT_TIMESTAMP),
('2024-07-31', 'BD', 2020, CURRENT_TIMESTAMP),
('2024-07-31', 'KS', 2220, CURRENT_TIMESTAMP),

-- 2024-06-30
('2024-06-30', 'SH', 830, CURRENT_TIMESTAMP),
('2024-06-30', 'SC', 1230, CURRENT_TIMESTAMP),
('2024-06-30', 'TA', 2830, CURRENT_TIMESTAMP),
('2024-06-30', 'NL', 1980, CURRENT_TIMESTAMP),
('2024-06-30', 'NE', 1380, CURRENT_TIMESTAMP),
('2024-06-30', 'PN', 230, CURRENT_TIMESTAMP),
('2024-06-30', 'HA', 334, CURRENT_TIMESTAMP),
('2024-06-30', 'TS', 1010, CURRENT_TIMESTAMP),
('2024-06-30', 'XT', 610, CURRENT_TIMESTAMP),
('2024-06-30', 'SH2', 2350, CURRENT_TIMESTAMP),
('2024-06-30', 'NL2', 140, CURRENT_TIMESTAMP),
('2024-06-30', 'TA2', 4250, CURRENT_TIMESTAMP),
('2024-06-30', 'PN2', 2980, CURRENT_TIMESTAMP),
('2024-06-30', 'SC2', 1140, CURRENT_TIMESTAMP),
('2024-06-30', 'HS', 1850, CURRENT_TIMESTAMP),
('2024-06-30', 'JG', 1450, CURRENT_TIMESTAMP),
('2024-06-30', 'GJ', 2550, CURRENT_TIMESTAMP),
('2024-06-30', 'PS', 1250, CURRENT_TIMESTAMP),
('2024-06-30', 'LS', 940, CURRENT_TIMESTAMP),
('2024-06-30', 'NS', 2750, CURRENT_TIMESTAMP),
('2024-06-30', 'KR', 3300, CURRENT_TIMESTAMP),
('2024-06-30', 'BD', 2050, CURRENT_TIMESTAMP),
('2024-06-30', 'KS', 2250, CURRENT_TIMESTAMP),

-- 2024-05-31
('2024-05-31', 'SH', 1000, CURRENT_TIMESTAMP),
('2024-05-31', 'SC', 1300, CURRENT_TIMESTAMP),
('2024-05-31', 'TA', 2500, CURRENT_TIMESTAMP),
('2024-05-31', 'NL', 2100, CURRENT_TIMESTAMP),
('2024-05-31', 'NE', 1400, CURRENT_TIMESTAMP),
('2024-05-31', 'PN', 2350, CURRENT_TIMESTAMP),
('2024-05-31', 'HA', 2850, CURRENT_TIMESTAMP),
('2024-05-31', 'TS', 1100, CURRENT_TIMESTAMP),
('2024-05-31', 'XT', 620, CURRENT_TIMESTAMP),
('2024-05-31', 'SH2', 2400, CURRENT_TIMESTAMP),
('2024-05-31', 'NL2', 1550, CURRENT_TIMESTAMP),
('2024-05-31', 'TA2', 4300, CURRENT_TIMESTAMP),
('2024-05-31', 'PN2', 2950, CURRENT_TIMESTAMP),
('2024-05-31', 'SC2', 1160, CURRENT_TIMESTAMP),
('2024-05-31', 'HS', 1900, CURRENT_TIMESTAMP),
('2024-05-31', 'JG', 1460, CURRENT_TIMESTAMP),
('2024-05-31', 'GJ', 2600, CURRENT_TIMESTAMP),
('2024-05-31', 'PS', 1300, CURRENT_TIMESTAMP),
('2024-05-31', 'LS', 960, CURRENT_TIMESTAMP),
('2024-05-31', 'NS', 2800, CURRENT_TIMESTAMP),
('2024-05-31', 'KR', 3400, CURRENT_TIMESTAMP),
('2024-05-31', 'BD', 2100, CURRENT_TIMESTAMP),
('2024-05-31', 'KS', 2300, CURRENT_TIMESTAMP),

-- 2024-04-30
('2024-04-30', 'SH', 2600, CURRENT_TIMESTAMP),
('2024-04-30', 'SC', 250, CURRENT_TIMESTAMP),
('2024-04-30', 'TA', 1150, CURRENT_TIMESTAMP),
('2024-04-30', 'NL', 900, CURRENT_TIMESTAMP),
('2024-04-30', 'NE', 1400, CURRENT_TIMESTAMP),
('2024-04-30', 'PN', 1450, CURRENT_TIMESTAMP),
('2024-04-30', 'HA', 3230, CURRENT_TIMESTAMP),
('2024-04-30', 'TS', -670, CURRENT_TIMESTAMP),
('2024-04-30', 'XT', 520, CURRENT_TIMESTAMP),
('2024-04-30', 'SH2', 1900, CURRENT_TIMESTAMP),
('2024-04-30', 'NL2', 1060, CURRENT_TIMESTAMP),
('2024-04-30', 'TA2', 1300, CURRENT_TIMESTAMP),
('2024-04-30', 'PN2', 4300, CURRENT_TIMESTAMP),
('2024-04-30', 'SC2', 1060, CURRENT_TIMESTAMP),
('2024-04-30', 'HS', 680, CURRENT_TIMESTAMP),
('2024-04-30', 'JG', 140, CURRENT_TIMESTAMP),
('2024-04-30', 'GJ', 2530, CURRENT_TIMESTAMP),
('2024-04-30', 'PS', 1280, CURRENT_TIMESTAMP),
('2024-04-30', 'LS', 960, CURRENT_TIMESTAMP),
('2024-04-30', 'NS', 1780, CURRENT_TIMESTAMP),
('2024-04-30', 'KR', 3080, CURRENT_TIMESTAMP),
('2024-04-30', 'BD', 1080, CURRENT_TIMESTAMP),
('2024-04-30', 'KS', 3180, CURRENT_TIMESTAMP);

'''